<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Salary Management System - December 2025</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @media print {
            .no-print {
                display: none !important;
            }
            .print-full-width {
                width: 100% !important;
                max-width: 100% !important;
                padding: 0 !important;
                margin: 0 !important;
            }
            body {
                background: white !important;
                font-size: 12px !important;
            }
            .break-inside-avoid {
                break-inside: avoid;
            }
            .salary-slip-page {
                page-break-after: always;
                margin: 20px;
                padding: 20px;
                border: 1px solid #ccc;
            }
        }
        
        .salary-slip-container {
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            background: white;
            padding: 20mm;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        @page {
            size: A4;
            margin: 20mm;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { jsPDF } = window.jspdf;

        // Embedded employee data
        const INITIAL_EMPLOYEE_DATA = [...]; // Your existing employee data remains here

        function SalaryApp() {
            const [employees, setEmployees] = useState(() => {
                const saved = localStorage.getItem('salaryEmployees');
                return saved ? JSON.parse(saved) : INITIAL_EMPLOYEE_DATA;
            });
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedEmployee, setSelectedEmployee] = useState(null);
            const [filterPaid, setFilterPaid] = useState('all');
            const [filterDepartment, setFilterDepartment] = useState('all');
            const [showAddForm, setShowAddForm] = useState(false);
            const [showImportModal, setShowImportModal] = useState(false);
            const [editMode, setEditMode] = useState(false);
            const [importStatus, setImportStatus] = useState('');
            const [showSlipModal, setShowSlipModal] = useState(false);
            const [selectedSlipEmployee, setSelectedSlipEmployee] = useState(null);
            const [slipType, setSlipType] = useState('individual'); // 'individual' or 'all'
            const fileInputRef = useRef(null);
            
            // New employee form state
            const [newEmployee, setNewEmployee] = useState({
                department: 'Ladies',
                cardNo: '',
                name: '',
                previousDue: 0,
                overtimeDays: 0,
                regularDays: 0,
                overtimeHours: 0,
                regularHours: 0,
                hourlyRate: 31.25,
                deduction: 0,
                advance: 0,
                salaryPaid: 0
            });

            // Save to localStorage whenever employees change
            useEffect(() => {
                localStorage.setItem('salaryEmployees', JSON.stringify(employees));
            }, [employees]);

            const filteredEmployees = employees.filter(emp => {
                const matchesSearch = emp.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                     emp.cardNo.toString().includes(searchTerm);
                
                const matchesFilter = filterPaid === 'all' ||
                                     (filterPaid === 'paid' && emp.salaryPaid > 0 && emp.dueNextMonth === 0) ||
                                     (filterPaid === 'unpaid' && emp.salaryPaid === 0) ||
                                     (filterPaid === 'partial' && emp.salaryPaid > 0 && emp.dueNextMonth > 0);
                
                const matchesDepartment = filterDepartment === 'all' || emp.department === filterDepartment;
                
                return matchesSearch && matchesFilter && matchesDepartment;
            });

            const totalSalary = filteredEmployees.reduce((sum, emp) => sum + (parseFloat(emp.totalSalary) || 0), 0);
            const totalPaid = filteredEmployees.reduce((sum, emp) => sum + (parseFloat(emp.salaryPaid) || 0), 0);
            const totalDue = filteredEmployees.reduce((sum, emp) => sum + (parseFloat(emp.dueNextMonth) || 0), 0);

            const ladiesCount = employees.filter(e => e.department === 'Ladies').length;
            const gentsCount = employees.filter(e => e.department === 'Gents').length;

            const calculateSalary = (emp) => {
                const totalDays = parseFloat(emp.overtimeDays || 0) + parseFloat(emp.regularDays || 0);
                const totalHours = parseFloat(emp.overtimeHours || 0) + parseFloat(emp.regularHours || 0);
                const overtimePay = parseFloat(emp.overtimeHours || 0) * parseFloat(emp.hourlyRate || 0);
                const regularPay = parseFloat(emp.regularHours || 0) * parseFloat(emp.hourlyRate || 0);
                const totalSalary = overtimePay + regularPay - parseFloat(emp.deduction || 0) - parseFloat(emp.advance || 0) + parseFloat(emp.previousDue || 0);
                const dueNextMonth = totalSalary - parseFloat(emp.salaryPaid || 0);

                return {
                    totalDays,
                    totalHours,
                    overtimePay,
                    regularPay,
                    totalSalary,
                    dueNextMonth
                };
            };

            const handleFileUpload = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                setImportStatus('Reading file...');
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        let importedEmployees = [];
                        let sheetsProcessed = 0;

                        // Process each sheet
                        workbook.SheetNames.forEach(sheetName => {
                            const normalizedSheetName = sheetName.toUpperCase().trim();
                            // Check for variations of Ladies sheet name
                            if (normalizedSheetName === 'LEDIES' || normalizedSheetName === 'LADIES' || 
                                normalizedSheetName === 'GENTS') {
                                
                                const worksheet = workbook.Sheets[sheetName];
                                const sheetData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                                
                                const department = (normalizedSheetName === 'LEDIES' || normalizedSheetName === 'LADIES') ? 'Ladies' : 'Gents';
                                
                                // Process rows starting from row 4 (index 3)
                                for (let i = 3; i < sheetData.length; i++) {
                                    const row = sheetData[i];
                                    
                                    // Check if row has name (column index 3)
                                    if (row && row[2] && row[3]) {
                                        const safeFloat = (val, def = 0) => {
                                            if (val === null || val === undefined || val === '' || val === '-') return def;
                                            const num = parseFloat(val);
                                            return isNaN(num) ? def : num;
                                        };
                                        
                                        const safeString = (val) => {
                                            return val ? String(val).trim() : '';
                                        };
                                        
                                        const employee = {
                                            id: `${department[0]}${importedEmployees.filter(e => e.department === department).length + 1}`,
                                            department: department,
                                            cardNo: safeString(row[1]),
                                            slNo: safeString(row[2]),
                                            name: safeString(row[3]),
                                            previousDue: safeFloat(row[4]),
                                            overtimeDays: safeFloat(row[36]),
                                            regularDays: safeFloat(row[37]),
                                            totalDays: safeFloat(row[38]),
                                            overtimeHours: safeFloat(row[39]),
                                            regularHours: safeFloat(row[40]),
                                            totalHours: safeFloat(row[41]),
                                            hourlyRate: safeFloat(row[42], department === 'Ladies' ? 31.25 : 33.33),
                                            overtimePay: safeFloat(row[43]),
                                            regularPay: safeFloat(row[44]),
                                            deduction: safeFloat(row[45]),
                                            advance: safeFloat(row[46]),
                                            totalSalary: safeFloat(row[47]),
                                            salaryPaid: safeFloat(row[48]),
                                            dueNextMonth: safeFloat(row[49])
                                        };
                                        
                                        importedEmployees.push(employee);
                                    }
                                }
                                sheetsProcessed++;
                            }
                        });

                        if (importedEmployees.length > 0) {
                            setEmployees(importedEmployees);
                            setImportStatus(`✓ Successfully imported ${importedEmployees.length} employees from ${sheetsProcessed} sheet(s)!`);
                            setTimeout(() => {
                                setShowImportModal(false);
                                setImportStatus('');
                            }, 2000);
                        } else {
                            setImportStatus('❌ No valid employee data found in the Excel file. Please check the format.');
                        }
                        
                    } catch (error) {
                        console.error('Error processing file:', error);
                        setImportStatus('❌ Error processing file. Please ensure it matches the required format.');
                    }
                };
                
                reader.onerror = () => {
                    setImportStatus('❌ Error reading file. Please try again.');
                };
                
                reader.readAsArrayBuffer(file);
            };

            const handleAddEmployee = () => {
                const calculated = calculateSalary(newEmployee);
                const maxId = Math.max(...employees.map(e => {
                    const numId = parseInt(e.id.substring(1));
                    return isNaN(numId) ? 0 : numId;
                }), 0);
                
                const newEmp = {
                    ...newEmployee,
                    id: `${newEmployee.department[0]}${maxId + 1}`,
                    slNo: employees.filter(e => e.department === newEmployee.department).length + 1,
                    ...calculated
                };

                setEmployees([...employees, newEmp]);
                setShowAddForm(false);
                setNewEmployee({
                    department: 'Ladies',
                    cardNo: '',
                    name: '',
                    previousDue: 0,
                    overtimeDays: 0,
                    regularDays: 0,
                    overtimeHours: 0,
                    regularHours: 0,
                    hourlyRate: 31.25,
                    deduction: 0,
                    advance: 0,
                    salaryPaid: 0
                });
            };

            const handleUpdateEmployee = (updatedEmp) => {
                const calculated = calculateSalary(updatedEmp);
                const updated = {
                    ...updatedEmp,
                    ...calculated
                };
                
                setEmployees(employees.map(emp => 
                    emp.id === updated.id ? updated : emp
                ));
                setSelectedEmployee(null);
                setEditMode(false);
            };

            const handleDeleteEmployee = (id) => {
                if (confirm('Are you sure you want to delete this employee?')) {
                    setEmployees(employees.filter(emp => emp.id !== id));
                    setSelectedEmployee(null);
                }
            };

            const handlePrint = () => {
                window.print();
            };

            const handleExportData = () => {
                const dataStr = JSON.stringify(employees, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `salary-data-${new Date().toISOString().split('T')[0]}.json`;
                link.click();
            };

            const handleResetData = () => {
                if (confirm('Are you sure you want to reset to original data? This will delete all changes.')) {
                    setEmployees(INITIAL_EMPLOYEE_DATA);
                    localStorage.removeItem('salaryEmployees');
                }
            };

            // New Salary Slip Functions
            const handlePrintSalarySlip = (employee) => {
                setSelectedSlipEmployee(employee);
                setSlipType('individual');
                setShowSlipModal(true);
            };

            const handlePrintAllSlips = () => {
                setSlipType('all');
                setShowSlipModal(true);
            };

            const generateIndividualSlip = () => {
                if (!selectedSlipEmployee) return null;
                
                const slipDate = new Date().toLocaleDateString('en-IN', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                const netSalary = selectedSlipEmployee.totalSalary;
                const netPayable = selectedSlipEmployee.salaryPaid;
                const dueAmount = selectedSlipEmployee.dueNextMonth;
                
                return (
                    <div className="salary-slip-container" id="salary-slip-individual">
                        {/* Header */}
                        <div className="text-center mb-8 border-b-2 border-gray-800 pb-4">
                            <h1 className="text-3xl font-bold text-gray-900">Salary Slip</h1>
                            <p className="text-gray-600 mt-2">For the month of December 2025</p>
                            <p className="text-sm text-gray-500">Issued on: {slipDate}</p>
                        </div>
                        
                        {/* Company Details */}
                        <div className="mb-6">
                            <h2 className="text-xl font-bold text-gray-900 mb-2">ABC Manufacturing Company</h2>
                            <p className="text-gray-600">Industrial Area, Rourkela, Odisha - 769042</p>
                            <p className="text-gray-600">Phone: 0661-123456 | Email: accounts@abccompany.in</p>
                        </div>
                        
                        {/* Employee Details */}
                        <div className="grid grid-cols-2 gap-4 mb-6">
                            <div className="bg-gray-50 p-4 rounded-lg">
                                <h3 className="font-bold text-gray-700 mb-2">Employee Information</h3>
                                <table className="w-full text-sm">
                                    <tbody>
                                        <tr>
                                            <td className="py-1 text-gray-600">Employee Name:</td>
                                            <td className="py-1 font-semibold">{selectedSlipEmployee.name}</td>
                                        </tr>
                                        <tr>
                                            <td className="py-1 text-gray-600">Employee ID:</td>
                                            <td className="py-1">{selectedSlipEmployee.id}</td>
                                        </tr>
                                        <tr>
                                            <td className="py-1 text-gray-600">Card No:</td>
                                            <td className="py-1">{selectedSlipEmployee.cardNo}</td>
                                        </tr>
                                        <tr>
                                            <td className="py-1 text-gray-600">Department:</td>
                                            <td className="py-1">{selectedSlipEmployee.department}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <div className="bg-gray-50 p-4 rounded-lg">
                                <h3 className="font-bold text-gray-700 mb-2">Salary Details</h3>
                                <table className="w-full text-sm">
                                    <tbody>
                                        <tr>
                                            <td className="py-1 text-gray-600">Payment Date:</td>
                                            <td className="py-1">{slipDate}</td>
                                        </tr>
                                        <tr>
                                            <td className="py-1 text-gray-600">Payment Status:</td>
                                            <td className="py-1 font-semibold">
                                                {selectedSlipEmployee.salaryPaid === 0 ? (
                                                    <span className="text-red-600">Unpaid</span>
                                                ) : selectedSlipEmployee.dueNextMonth > 0 ? (
                                                    <span className="text-orange-600">Partially Paid</span>
                                                ) : (
                                                    <span className="text-green-600">Fully Paid</span>
                                                )}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td className="py-1 text-gray-600">Net Salary:</td>
                                            <td className="py-1 font-bold">₹{netSalary.toFixed(2)}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        {/* Salary Breakdown */}
                        <div className="mb-8">
                            <h3 className="text-lg font-bold text-gray-900 mb-4 border-b pb-2">Salary Breakdown</h3>
                            <table className="w-full border-collapse border border-gray-300 text-sm">
                                <thead>
                                    <tr className="bg-gray-100">
                                        <th className="border border-gray-300 p-2 text-left">Description</th>
                                        <th className="border border-gray-300 p-2 text-left">Days</th>
                                        <th className="border border-gray-300 p-2 text-left">Hours</th>
                                        <th className="border border-gray-300 p-2 text-left">Rate (₹)</th>
                                        <th className="border border-gray-300 p-2 text-left">Amount (₹)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td className="border border-gray-300 p-2">Previous Due</td>
                                        <td className="border border-gray-300 p-2">-</td>
                                        <td className="border border-gray-300 p-2">-</td>
                                        <td className="border border-gray-300 p-2">-</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.previousDue.toFixed(2)}</td>
                                    </tr>
                                    <tr>
                                        <td className="border border-gray-300 p-2">Regular Days ({selectedSlipEmployee.regularDays} days)</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.regularDays}</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.regularHours}</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.hourlyRate.toFixed(2)}</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.regularPay.toFixed(2)}</td>
                                    </tr>
                                    <tr>
                                        <td className="border border-gray-300 p-2">Overtime ({selectedSlipEmployee.overtimeDays} days)</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.overtimeDays}</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.overtimeHours}</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.hourlyRate.toFixed(2)}</td>
                                        <td className="border border-gray-300 p-2">{selectedSlipEmployee.overtimePay.toFixed(2)}</td>
                                    </tr>
                                    <tr className="bg-gray-50 font-bold">
                                        <td className="border border-gray-300 p-2">Gross Salary</td>
                                        <td className="border border-gray-300 p-2" colSpan="3"></td>
                                        <td className="border border-gray-300 p-2">
                                            {(selectedSlipEmployee.previousDue + selectedSlipEmployee.regularPay + selectedSlipEmployee.overtimePay).toFixed(2)}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td className="border border-gray-300 p-2 text-red-600">Deductions</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-{selectedSlipEmployee.deduction.toFixed(2)}</td>
                                    </tr>
                                    <tr>
                                        <td className="border border-gray-300 p-2 text-red-600">Advance Deduction</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-</td>
                                        <td className="border border-gray-300 p-2 text-red-600">-{selectedSlipEmployee.advance.toFixed(2)}</td>
                                    </tr>
                                    <tr className="bg-green-50 font-bold">
                                        <td className="border border-gray-300 p-2">NET SALARY PAYABLE</td>
                                        <td className="border border-gray-300 p-2" colSpan="3"></td>
                                        <td className="border border-gray-300 p-2 text-green-700">{netSalary.toFixed(2)}</td>
                                    </tr>
                                    <tr className="bg-blue-50">
                                        <td className="border border-gray-300 p-2 font-bold">PAYMENTS MADE</td>
                                        <td className="border border-gray-300 p-2" colSpan="3"></td>
                                        <td className="border border-gray-300 p-2 font-bold text-blue-700">{selectedSlipEmployee.salaryPaid.toFixed(2)}</td>
                                    </tr>
                                    <tr className="bg-orange-50">
                                        <td className="border border-gray-300 p-2 font-bold">DUE FOR NEXT MONTH</td>
                                        <td className="border border-gray-300 p-2" colSpan="3"></td>
                                        <td className="border border-gray-300 p-2 font-bold text-orange-700">{dueAmount.toFixed(2)}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        
                        {/* Summary */}
                        <div className="mt-8 pt-4 border-t-2 border-gray-300">
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <h4 className="font-bold text-gray-700 mb-2">Summary</h4>
                                    <ul className="text-sm text-gray-600 space-y-1">
                                        <li>• Total Days Worked: {selectedSlipEmployee.totalDays}</li>
                                        <li>• Total Hours Worked: {selectedSlipEmployee.totalHours}</li>
                                        <li>• Hourly Rate: ₹{selectedSlipEmployee.hourlyRate.toFixed(2)}</li>
                                        <li>• Payment Mode: Bank Transfer / Cash</li>
                                    </ul>
                                </div>
                                <div className="text-right">
                                    <div className="mb-4">
                                        <p className="text-gray-600">For ABC Manufacturing Company</p>
                                        <div className="mt-8">
                                            <p className="border-t border-gray-300 pt-4 inline-block">
                                                Authorized Signatory
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {/* Footer */}
                        <div className="mt-8 pt-4 border-t border-gray-300 text-center text-xs text-gray-500">
                            <p>This is a computer-generated salary slip and does not require a signature.</p>
                            <p>Confidential Document - For Employee Use Only</p>
                        </div>
                    </div>
                );
            };

            const generateAllSlips = () => {
                const slipDate = new Date().toLocaleDateString('en-IN', {
                    day: '2-digit',
                    month: 'short',
                    year: 'numeric'
                });
                
                return (
                    <div id="salary-slips-all">
                        {filteredEmployees.map((employee, index) => (
                            <div key={employee.id} className="salary-slip-container" style={{ pageBreakAfter: 'always' }}>
                                {/* Individual slip content similar to generateIndividualSlip */}
                                <div className="text-center mb-6 border-b-2 border-gray-800 pb-3">
                                    <h1 className="text-2xl font-bold text-gray-900">Salary Slip - {employee.name}</h1>
                                    <p className="text-gray-600 mt-1">December 2025 | Slip #{index + 1}</p>
                                </div>
                                
                                <div className="grid grid-cols-2 gap-4 mb-4">
                                    <div>
                                        <p className="text-sm"><strong>Employee:</strong> {employee.name}</p>
                                        <p className="text-sm"><strong>ID:</strong> {employee.id} | <strong>Card:</strong> {employee.cardNo}</p>
                                    </div>
                                    <div className="text-right">
                                        <p className="text-sm"><strong>Department:</strong> {employee.department}</p>
                                        <p className="text-sm"><strong>Status:</strong> 
                                            {employee.salaryPaid === 0 ? ' Unpaid' : employee.dueNextMonth > 0 ? ' Partial' : ' Paid'}
                                        </p>
                                    </div>
                                </div>
                                
                                <table className="w-full border-collapse border border-gray-300 text-xs mb-4">
                                    <thead>
                                        <tr className="bg-gray-100">
                                            <th className="border border-gray-300 p-1">Description</th>
                                            <th className="border border-gray-300 p-1">Days</th>
                                            <th className="border border-gray-300 p-1">Hours</th>
                                            <th className="border border-gray-300 p-1">Rate</th>
                                            <th className="border border-gray-300 p-1">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td className="border border-gray-300 p-1">Previous Due</td>
                                            <td className="border border-gray-300 p-1">-</td>
                                            <td className="border border-gray-300 p-1">-</td>
                                            <td className="border border-gray-300 p-1">-</td>
                                            <td className="border border-gray-300 p-1">{employee.previousDue.toFixed(2)}</td>
                                        </tr>
                                        <tr>
                                            <td className="border border-gray-300 p-1">Regular</td>
                                            <td className="border border-gray-300 p-1">{employee.regularDays}</td>
                                            <td className="border border-gray-300 p-1">{employee.regularHours}</td>
                                            <td className="border border-gray-300 p-1">{employee.hourlyRate.toFixed(2)}</td>
                                            <td className="border border-gray-300 p-1">{employee.regularPay.toFixed(2)}</td>
                                        </tr>
                                        <tr>
                                            <td className="border border-gray-300 p-1">Overtime</td>
                                            <td className="border border-gray-300 p-1">{employee.overtimeDays}</td>
                                            <td className="border border-gray-300 p-1">{employee.overtimeHours}</td>
                                            <td className="border border-gray-300 p-1">{employee.hourlyRate.toFixed(2)}</td>
                                            <td className="border border-gray-300 p-1">{employee.overtimePay.toFixed(2)}</td>
                                        </tr>
                                        <tr className="bg-gray-50 font-bold">
                                            <td className="border border-gray-300 p-1">Gross</td>
                                            <td className="border border-gray-300 p-1" colSpan="3"></td>
                                            <td className="border border-gray-300 p-1">
                                                {(employee.previousDue + employee.regularPay + employee.overtimePay).toFixed(2)}
                                            </td>
                                        </tr>
                                        <tr className="text-red-600">
                                            <td className="border border-gray-300 p-1">Deductions</td>
                                            <td className="border border-gray-300 p-1" colSpan="3"></td>
                                            <td className="border border-gray-300 p-1">-{employee.deduction.toFixed(2)}</td>
                                        </tr>
                                        <tr className="text-red-600">
                                            <td className="border border-gray-300 p-1">Advance</td>
                                            <td className="border border-gray-300 p-1" colSpan="3"></td>
                                            <td className="border border-gray-300 p-1">-{employee.advance.toFixed(2)}</td>
                                        </tr>
                                        <tr className="bg-green-50 font-bold">
                                            <td className="border border-gray-300 p-1">NET SALARY</td>
                                            <td className="border border-gray-300 p-1" colSpan="3"></td>
                                            <td className="border border-gray-300 p-1">{employee.totalSalary.toFixed(2)}</td>
                                        </tr>
                                        <tr className="bg-blue-50">
                                            <td className="border border-gray-300 p-1">PAID</td>
                                            <td className="border border-gray-300 p-1" colSpan="3"></td>
                                            <td className="border border-gray-300 p-1">{employee.salaryPaid.toFixed(2)}</td>
                                        </tr>
                                        <tr className="bg-orange-50">
                                            <td className="border border-gray-300 p-1">DUE NEXT</td>
                                            <td className="border border-gray-300 p-1" colSpan="3"></td>
                                            <td className="border border-gray-300 p-1">{employee.dueNextMonth.toFixed(2)}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                
                                <div className="text-xs text-center text-gray-500 mt-4">
                                    <p>Generated on {slipDate} | ABC Manufacturing Company</p>
                                </div>
                            </div>
                        ))}
                    </div>
                );
            };

            const downloadSlipAsPDF = async () => {
                const element = slipType === 'individual' 
                    ? document.getElementById('salary-slip-individual')
                    : document.getElementById('salary-slips-all');
                
                if (!element) return;

                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });

                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });

                const imgWidth = 210;
                const imgHeight = canvas.height * imgWidth / canvas.width;
                
                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                
                const fileName = slipType === 'individual'
                    ? `salary-slip-${selectedSlipEmployee.name}-${new Date().toISOString().split('T')[0]}.pdf`
                    : `all-salary-slips-${new Date().toISOString().split('T')[0]}.pdf`;
                
                pdf.save(fileName);
            };

            const printSlip = () => {
                const element = slipType === 'individual'
                    ? document.getElementById('salary-slip-individual')
                    : document.getElementById('salary-slips-all');
                
                if (!element) return;

                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <html>
                    <head>
                        <title>Salary Slip${slipType === 'all' ? 's' : ''} - December 2025</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
                            @page { size: A4; margin: 20mm; }
                            .salary-slip-container { width: 210mm; min-height: 297mm; margin: 0 auto; }
                        </style>
                    </head>
                    <body>
                        ${element.outerHTML}
                    </body>
                    </html>
                `);
                printWindow.document.close();
                printWindow.focus();
                setTimeout(() => {
                    printWindow.print();
                    printWindow.close();
                }, 500);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4 md:p-6">
                    <div className="max-w-7xl mx-auto print-full-width">
                        {/* Header */}
                        <div className="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-6 break-inside-avoid">
                            <div className="flex justify-between items-start mb-4">
                                <div>
                                    <h1 className="text-3xl md:text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2">
                                        Complete Salary Management System
                                    </h1>
                                    <p className="text-gray-600">December 2025 - All Departments</p>
                                </div>
                                <div className="no-print flex gap-2 flex-wrap">
                                    <button
                                        onClick={() => setShowImportModal(true)}
                                        className="px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition flex items-center gap-2"
                                    >
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                        </svg>
                                        Import Excel
                                    </button>
                                    <button
                                        onClick={() => setShowAddForm(true)}
                                        className="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition flex items-center gap-2"
                                    >
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4" />
                                        </svg>
                                        Add Employee
                                    </button>
                                    <button
                                        onClick={handlePrintAllSlips}
                                        className="px-4 py-2 bg-teal-600 text-white rounded-lg font-medium hover:bg-teal-700 transition flex items-center gap-2"
                                    >
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                        </svg>
                                        Print All Slips
                                    </button>
                                    <button
                                        onClick={handlePrint}
                                        className="px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition flex items-center gap-2"
                                    >
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                                        </svg>
                                        Print Report
                                    </button>
                                    <button
                                        onClick={handleExportData}
                                        className="px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition flex items-center gap-2"
                                    >
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                        Export Data
                                    </button>
                                    <button
                                        onClick={handleResetData}
                                        className="px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition flex items-center gap-2"
                                    >
                                        <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                                        </svg>
                                        Reset
                                    </button>
                                </div>
                            </div>
                            
                            {/* Summary Cards */}
                            <div className="grid grid-cols-2 md:grid-cols-5 gap-3 md:gap-4 mt-6">
                                <div className="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-4 md:p-5 text-white break-inside-avoid">
                                    <p className="text-blue-100 text-xs md:text-sm mb-1">Total Employees</p>
                                    <p className="text-2xl md:text-3xl font-bold">{filteredEmployees.length}</p>
                                    <p className="text-xs text-blue-100 mt-1">L: {ladiesCount} | G: {gentsCount}</p>
                                </div>
                                <div className="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-4 md:p-5 text-white break-inside-avoid">
                                    <p className="text-green-100 text-xs md:text-sm mb-1">Total Salary</p>
                                    <p className="text-xl md:text-3xl font-bold">₹{totalSalary.toFixed(0)}</p>
                                </div>
                                <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-4 md:p-5 text-white break-inside-avoid">
                                    <p className="text-purple-100 text-xs md:text-sm mb-1">Total Paid</p>
                                    <p className="text-xl md:text-3xl font-bold">₹{totalPaid.toFixed(0)}</p>
                                </div>
                                <div className="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-4 md:p-5 text-white break-inside-avoid">
                                    <p className="text-orange-100 text-xs md:text-sm mb-1">Total Due</p>
                                    <p className="text-xl md:text-3xl font-bold">₹{totalDue.toFixed(0)}</p>
                                </div>
                                <div className="bg-gradient-to-br from-pink-500 to-pink-600 rounded-xl p-4 md:p-5 text-white break-inside-avoid">
                                    <p className="text-pink-100 text-xs md:text-sm mb-1">Payment Rate</p>
                                    <p className="text-xl md:text-3xl font-bold">
                                        {totalSalary > 0 ? ((totalPaid / totalSalary) * 100).toFixed(0) : 0}%
                                    </p>
                                </div>
                            </div>
                        </div>

                        {/* Search and Filter */}
                        <div className="bg-white rounded-2xl shadow-xl p-4 md:p-6 mb-6 no-print">
                            <div className="flex flex-col gap-3">
                                <input
                                    type="text"
                                    placeholder="Search by name or card number..."
                                    value={searchTerm}
                                    onChange={(e) => setSearchTerm(e.target.value)}
                                    className="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                                />
                                <div className="flex gap-2 overflow-x-auto">
                                    <select
                                        value={filterDepartment}
                                        onChange={(e) => setFilterDepartment(e.target.value)}
                                        className="px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500"
                                    >
                                        <option value="all">All Departments</option>
                                        <option value="Ladies">Ladies</option>
                                        <option value="Gents">Gents</option>
                                    </select>
                                    <button
                                        onClick={() => setFilterPaid('all')}
                                        className={`px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium transition whitespace-nowrap ${
                                            filterPaid === 'all' 
                                            ? 'bg-purple-600 text-white' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                        }`}
                                    >
                                        All
                                    </button>
                                    <button
                                        onClick={() => setFilterPaid('paid')}
                                        className={`px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium transition whitespace-nowrap ${
                                            filterPaid === 'paid' 
                                            ? 'bg-green-600 text-white' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                        }`}
                                    >
                                        Paid
                                    </button>
                                    <button
                                        onClick={() => setFilterPaid('unpaid')}
                                        className={`px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium transition whitespace-nowrap ${
                                            filterPaid === 'unpaid' 
                                            ? 'bg-red-600 text-white' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                        }`}
                                    >
                                        Unpaid
                                    </button>
                                    <button
                                        onClick={() => setFilterPaid('partial')}
                                        className={`px-4 md:px-6 py-2 md:py-3 rounded-lg font-medium transition whitespace-nowrap ${
                                            filterPaid === 'partial' 
                                            ? 'bg-orange-600 text-white' 
                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                        }`}
                                    >
                                        Partial
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Employee Table */}
                        <div className="bg-white rounded-2xl shadow-xl overflow-hidden break-inside-avoid">
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-gradient-to-r from-purple-600 to-pink-600 text-white">
                                        <tr>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-left text-xs md:text-sm font-semibold">Dept</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-left text-xs md:text-sm font-semibold">Card</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-left text-xs md:text-sm font-semibold">Name</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-right text-xs md:text-sm font-semibold">Days</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-right text-xs md:text-sm font-semibold">Salary</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-right text-xs md:text-sm font-semibold">Paid</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-right text-xs md:text-sm font-semibold">Due</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-center text-xs md:text-sm font-semibold">Status</th>
                                            <th className="px-3 md:px-6 py-3 md:py-4 text-center text-xs md:text-sm font-semibold no-print">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {filteredEmployees.map((emp) => (
                                            <tr key={emp.id} className="hover:bg-gray-50 transition break-inside-avoid">
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm">
                                                    <span className={`px-2 py-1 rounded text-xs font-semibold ${
                                                        emp.department === 'Ladies' 
                                                        ? 'bg-pink-100 text-pink-800' 
                                                        : 'bg-blue-100 text-blue-800'
                                                    }`}>
                                                        {emp.department[0]}
                                                    </span>
                                                </td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm text-gray-900">{emp.cardNo}</td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm font-medium text-gray-900">{emp.name}</td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm text-gray-700 text-right">{emp.totalDays || 0}</td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm font-semibold text-gray-900 text-right">
                                                    ₹{parseFloat(emp.totalSalary || 0).toFixed(2)}
                                                </td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm text-green-600 font-medium text-right">
                                                    ₹{parseFloat(emp.salaryPaid || 0).toFixed(2)}
                                                </td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-xs md:text-sm text-orange-600 font-medium text-right">
                                                    ₹{parseFloat(emp.dueNextMonth || 0).toFixed(2)}
                                                </td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-center">
                                                    {emp.salaryPaid === 0 ? (
                                                        <span className="px-2 md:px-3 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800">
                                                            Unpaid
                                                        </span>
                                                    ) : emp.dueNextMonth > 0 ? (
                                                        <span className="px-2 md:px-3 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-800">
                                                            Partial
                                                        </span>
                                                    ) : (
                                                        <span className="px-2 md:px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">
                                                            Paid
                                                        </span>
                                                    )}
                                                </td>
                                                <td className="px-3 md:px-6 py-3 md:py-4 text-center no-print">
                                                    <button
                                                        onClick={() => handlePrintSalarySlip(emp)}
                                                        className="text-teal-600 hover:text-teal-800 font-medium text-xs md:text-sm mr-2"
                                                    >
                                                        Slip
                                                    </button>
                                                    <button
                                                        onClick={() => {
                                                            setSelectedEmployee(emp);
                                                            setEditMode(false);
                                                        }}
                                                        className="text-purple-600 hover:text-purple-800 font-medium text-xs md:text-sm mr-2"
                                                    >
                                                        View
                                                    </button>
                                                    <button
                                                        onClick={() => {
                                                            setSelectedEmployee(emp);
                                                            setEditMode(true);
                                                        }}
                                                        className="text-blue-600 hover:text-blue-800 font-medium text-xs md:text-sm mr-2"
                                                    >
                                                        Edit
                                                    </button>
                                                    <button
                                                        onClick={() => handleDeleteEmployee(emp.id)}
                                                        className="text-red-600 hover:text-red-800 font-medium text-xs md:text-sm"
                                                    >
                                                        Delete
                                                    </button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                    <tfoot className="bg-gray-50 font-bold">
                                        <tr>
                                            <td colSpan="4" className="px-3 md:px-6 py-4 text-right text-sm md:text-base">TOTAL:</td>
                                            <td className="px-3 md:px-6 py-4 text-right text-sm md:text-base">₹{totalSalary.toFixed(2)}</td>
                                            <td className="px-3 md:px-6 py-4 text-right text-sm md:text-base text-green-600">₹{totalPaid.toFixed(2)}</td>
                                            <td className="px-3 md:px-6 py-4 text-right text-sm md:text-base text-orange-600">₹{totalDue.toFixed(2)}</td>
                                            <td colSpan="2"></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                            
                            {filteredEmployees.length === 0 && (
                                <div className="text-center py-12 no-print">
                                    <p className="text-gray-500 text-lg">No employees found</p>
                                </div>
                            )}
                        </div>

                        {/* Print Footer */}
                        <div className="hidden print:block mt-8 pt-4 border-t-2 border-gray-300">
                            <p className="text-sm text-gray-600">Printed on: {new Date().toLocaleString()}</p>
                            <p className="text-sm text-gray-600">Complete Salary Management System - December 2025</p>
                        </div>
                    </div>

                    {/* Import Excel Modal */}
                    {showImportModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 no-print">
                            <div className="bg-white rounded-2xl max-w-2xl w-full">
                                <div className="bg-gradient-to-r from-indigo-600 to-blue-600 text-white p-6 rounded-t-2xl">
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <h2 className="text-2xl font-bold">Import Excel File</h2>
                                            <p className="text-indigo-100 mt-2">Upload salary data from Excel file</p>
                                        </div>
                                        <button
                                            onClick={() => {
                                                setShowImportModal(false);
                                                setImportStatus('');
                                            }}
                                            className="text-white hover:text-gray-200 text-3xl leading-none"
                                        >
                                            ×
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="p-6">
                                    <div className="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                                        <h3 className="font-semibold text-blue-900 mb-2">Required Format:</h3>
                                        <ul className="text-sm text-blue-800 space-y-1">
                                            <li>• Excel file (.xlsx or .xls)</li>
                                            <li>• Sheets named "LEDIES" or "LADIES" and/or "GENTS"</li>
                                            <li>• Same column structure as your original salary file</li>
                                            <li>• Data starting from row 4</li>
                                            <li>• Make sure the sheet names match exactly</li>
                                        </ul>
                                    </div>

                                    <div className="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                                        <input
                                            ref={fileInputRef}
                                            type="file"
                                            accept=".xlsx,.xls"
                                            onChange={handleFileUpload}
                                            className="hidden"
                                        />
                                        <svg className="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                                        </svg>
                                        <button
                                            onClick={() => fileInputRef.current?.click()}
                                            className="bg-indigo-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-indigo-700 transition"
                                        >
                                            Choose Excel File
                                        </button>
                                        <p className="text-sm text-gray-500 mt-2">or drag and drop</p>
                                    </div>

                                    {importStatus && (
                                        <div className={`mt-4 p-4 rounded-lg ${
                                            importStatus.includes('✓') 
                                            ? 'bg-green-50 text-green-800 border border-green-200' 
                                            : importStatus.includes('❌')
                                            ? 'bg-red-50 text-red-800 border border-red-200'
                                            : 'bg-blue-50 text-blue-800 border border-blue-200'
                                        }`}>
                                            <p className="font-medium">{importStatus}</p>
                                        </div>
                                    )}

                                    <div className="flex gap-3 mt-6">
                                        <button
                                            onClick={() => {
                                                setShowImportModal(false);
                                                setImportStatus('');
                                            }}
                                            className="flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-400 transition"
                                        >
                                            Close
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Salary Slip Modal */}
                    {showSlipModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 no-print overflow-y-auto">
                            <div className="bg-white rounded-2xl max-w-6xl w-full my-8">
                                <div className="bg-gradient-to-r from-teal-600 to-blue-600 text-white p-6 rounded-t-2xl">
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <h2 className="text-2xl font-bold">
                                                {slipType === 'individual' ? 'Salary Slip' : 'All Salary Slips'}
                                            </h2>
                                            <p className="text-white/80 mt-1">
                                                {slipType === 'individual' 
                                                    ? `For: ${selectedSlipEmployee?.name}` 
                                                    : `Total: ${filteredEmployees.length} employees`}
                                            </p>
                                        </div>
                                        <button
                                            onClick={() => setShowSlipModal(false)}
                                            className="text-white hover:text-gray-200 text-3xl leading-none"
                                        >
                                            ×
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="p-6">
                                    <div className="no-print flex gap-3 mb-6">
                                        <button
                                            onClick={downloadSlipAsPDF}
                                            className="bg-teal-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-teal-700 transition flex items-center gap-2"
                                        >
                                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                            </svg>
                                            Download as PDF
                                        </button>
                                        <button
                                            onClick={printSlip}
                                            className="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition flex items-center gap-2"
                                        >
                                            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
                                            </svg>
                                            Print Slip{slipType === 'all' ? 's' : ''}
                                        </button>
                                        <button
                                            onClick={() => setShowSlipModal(false)}
                                            className="bg-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-400 transition"
                                        >
                                            Close
                                        </button>
                                    </div>
                                    
                                    <div className="overflow-auto max-h-[60vh]">
                                        {slipType === 'individual' ? generateIndividualSlip() : generateAllSlips()}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Add Employee Modal */}
                    {showAddForm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 no-print overflow-y-auto">
                            <div className="bg-white rounded-2xl max-w-2xl w-full my-8">
                                <div className="bg-gradient-to-r from-green-600 to-emerald-600 text-white p-6 rounded-t-2xl">
                                    <div className="flex justify-between items-start">
                                        <h2 className="text-2xl font-bold">Add New Employee</h2>
                                        <button
                                            onClick={() => setShowAddForm(false)}
                                            className="text-white hover:text-gray-200 text-3xl leading-none"
                                        >
                                            ×
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="p-6 max-h-[70vh] overflow-y-auto">
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="col-span-2">
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Department</label>
                                            <select
                                                value={newEmployee.department}
                                                onChange={(e) => setNewEmployee({...newEmployee, department: e.target.value})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            >
                                                <option value="Ladies">Ladies</option>
                                                <option value="Gents">Gents</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Card No</label>
                                            <input
                                                type="text"
                                                value={newEmployee.cardNo}
                                                onChange={(e) => setNewEmployee({...newEmployee, cardNo: e.target.value})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Name *</label>
                                            <input
                                                type="text"
                                                value={newEmployee.name}
                                                onChange={(e) => setNewEmployee({...newEmployee, name: e.target.value})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                                required
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Previous Due (₹)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={newEmployee.previousDue}
                                                onChange={(e) => setNewEmployee({...newEmployee, previousDue: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Hourly Rate (₹)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={newEmployee.hourlyRate}
                                                onChange={(e) => setNewEmployee({...newEmployee, hourlyRate: parseFloat(e.target.value) || 31.25})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Overtime Days</label>
                                            <input
                                                type="number"
                                                step="0.5"
                                                value={newEmployee.overtimeDays}
                                                onChange={(e) => setNewEmployee({...newEmployee, overtimeDays: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Regular Days</label>
                                            <input
                                                type="number"
                                                step="0.5"
                                                value={newEmployee.regularDays}
                                                onChange={(e) => setNewEmployee({...newEmployee, regularDays: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Overtime Hours</label>
                                            <input
                                                type="number"
                                                step="0.5"
                                                value={newEmployee.overtimeHours}
                                                onChange={(e) => setNewEmployee({...newEmployee, overtimeHours: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Regular Hours</label>
                                            <input
                                                type="number"
                                                step="0.5"
                                                value={newEmployee.regularHours}
                                                onChange={(e) => setNewEmployee({...newEmployee, regularHours: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Deduction (₹)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={newEmployee.deduction}
                                                onChange={(e) => setNewEmployee({...newEmployee, deduction: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Advance (₹)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={newEmployee.advance}
                                                onChange={(e) => setNewEmployee({...newEmployee, advance: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                        
                                        <div>
                                            <label className="block text-sm font-semibold text-gray-700 mb-2">Salary Paid (₹)</label>
                                            <input
                                                type="number"
                                                step="0.01"
                                                value={newEmployee.salaryPaid}
                                                onChange={(e) => setNewEmployee({...newEmployee, salaryPaid: parseFloat(e.target.value) || 0})}
                                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500"
                                            />
                                        </div>
                                    </div>

                                    <div className="flex gap-3 mt-6">
                                        <button
                                            onClick={handleAddEmployee}
                                            disabled={!newEmployee.name}
                                            className="flex-1 bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition disabled:bg-gray-400"
                                        >
                                            Add Employee
                                        </button>
                                        <button
                                            onClick={() => setShowAddForm(false)}
                                            className="flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-400 transition"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Employee Detail/Edit Modal */}
                    {selectedEmployee && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 no-print overflow-y-auto">
                            <div className="bg-white rounded-2xl max-w-2xl w-full my-8">
                                <div className={`bg-gradient-to-r ${selectedEmployee.department === 'Ladies' ? 'from-pink-600 to-purple-600' : 'from-blue-600 to-emerald-600'} text-white p-6 rounded-t-2xl`}>
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <h2 className="text-xl md:text-2xl font-bold">{selectedEmployee.name}</h2>
                                            <p className="text-white/80 mt-1">Card No: {selectedEmployee.cardNo} | {selectedEmployee.department}</p>
                                        </div>
                                        <button
                                            onClick={() => {
                                                setSelectedEmployee(null);
                                                setEditMode(false);
                                            }}
                                            className="text-white hover:text-gray-200 text-3xl leading-none"
                                        >
                                            ×
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="p-6 max-h-[70vh] overflow-y-auto">
                                    {editMode ? (
                                        <EditEmployeeForm 
                                            employee={selectedEmployee}
                                            onSave={handleUpdateEmployee}
                                            onCancel={() => setEditMode(false)}
                                        />
                                    ) : (
                                        <EmployeeDetails employee={selectedEmployee} />
                                    )}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        function EmployeeDetails({ employee }) {
            return (
                <>
                    <div className="grid grid-cols-2 gap-4 mb-6">
                        <div className="bg-blue-50 p-4 rounded-lg">
                            <p className="text-sm text-gray-600 mb-1">Previous Due</p>
                            <p className="text-xl font-bold text-gray-900">₹{parseFloat(employee.previousDue || 0).toFixed(2)}</p>
                        </div>
                        <div className="bg-green-50 p-4 rounded-lg">
                            <p className="text-sm text-gray-600 mb-1">Hourly Rate</p>
                            <p className="text-xl font-bold text-gray-900">₹{parseFloat(employee.hourlyRate || 0).toFixed(2)}</p>
                        </div>
                    </div>

                    <div className="space-y-4">
                        <h3 className="font-bold text-gray-800 text-lg border-b pb-2">Working Hours</h3>
                        <div className="grid grid-cols-3 gap-3">
                            <div className="bg-gray-50 p-3 rounded-lg">
                                <p className="text-xs text-gray-600 mb-1">OT Days</p>
                                <p className="text-lg font-semibold">{employee.overtimeDays || 0}</p>
                            </div>
                            <div className="bg-gray-50 p-3 rounded-lg">
                                <p className="text-xs text-gray-600 mb-1">Regular</p>
                                <p className="text-lg font-semibold">{employee.regularDays || 0}</p>
                            </div>
                            <div className="bg-gray-50 p-3 rounded-lg">
                                <p className="text-xs text-gray-600 mb-1">Total</p>
                                <p className="text-lg font-semibold">{employee.totalDays || 0}</p>
                            </div>
                        </div>

                        <h3 className="font-bold text-gray-800 text-lg border-b pb-2 mt-6">Payment Breakdown</h3>
                        <div className="space-y-2">
                            <div className="flex justify-between py-2 border-b">
                                <span className="text-gray-600">Overtime Pay:</span>
                                <span className="font-semibold">₹{parseFloat(employee.overtimePay || 0).toFixed(2)}</span>
                            </div>
                            <div className="flex justify-between py-2 border-b">
                                <span className="text-gray-600">Regular Pay:</span>
                                <span className="font-semibold">₹{parseFloat(employee.regularPay || 0).toFixed(2)}</span>
                            </div>
                            <div className="flex justify-between py-2 border-b">
                                <span className="text-gray-600">Deduction:</span>
                                <span className="font-semibold text-red-600">-₹{parseFloat(employee.deduction || 0).toFixed(2)}</span>
                            </div>
                            <div className="flex justify-between py-2 border-b">
                                <span className="text-gray-600">Advance:</span>
                                <span className="font-semibold text-red-600">-₹{parseFloat(employee.advance || 0).toFixed(2)}</span>
                            </div>
                            <div className="flex justify-between py-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg px-4 mt-2">
                                <span className="font-bold text-gray-800">Total Salary:</span>
                                <span className="font-bold text-xl text-purple-600">₹{parseFloat(employee.totalSalary || 0).toFixed(2)}</span>
                            </div>
                            <div className="flex justify-between py-2 border-b">
                                <span className="text-gray-600">Salary Paid:</span>
                                <span className="font-semibold text-green-600">₹{parseFloat(employee.salaryPaid || 0).toFixed(2)}</span>
                            </div>
                            <div className="flex justify-between py-3 bg-orange-50 rounded-lg px-4">
                                <span className="font-bold text-gray-800">Due Next Month:</span>
                                <span className="font-bold text-xl text-orange-600">₹{parseFloat(employee.dueNextMonth || 0).toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                </>
            );
        }

        function EditEmployeeForm({ employee, onSave, onCancel }) {
            const [editedEmployee, setEditedEmployee] = useState({...employee});

            const handleSave = () => {
                if (editedEmployee.name) {
                    onSave(editedEmployee);
                }
            };

            return (
                <div className="space-y-4">
                    <div className="grid grid-cols-2 gap-4">
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Card No</label>
                            <input
                                type="text"
                                value={editedEmployee.cardNo}
                                onChange={(e) => setEditedEmployee({...editedEmployee, cardNo: e.target.value})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Name *</label>
                            <input
                                type="text"
                                value={editedEmployee.name}
                                onChange={(e) => setEditedEmployee({...editedEmployee, name: e.target.value})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                                required
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Previous Due (₹)</label>
                            <input
                                type="number"
                                step="0.01"
                                value={editedEmployee.previousDue}
                                onChange={(e) => setEditedEmployee({...editedEmployee, previousDue: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Hourly Rate (₹)</label>
                            <input
                                type="number"
                                step="0.01"
                                value={editedEmployee.hourlyRate}
                                onChange={(e) => setEditedEmployee({...editedEmployee, hourlyRate: parseFloat(e.target.value) || 31.25})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Overtime Days</label>
                            <input
                                type="number"
                                step="0.5"
                                value={editedEmployee.overtimeDays}
                                onChange={(e) => setEditedEmployee({...editedEmployee, overtimeDays: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Regular Days</label>
                            <input
                                type="number"
                                step="0.5"
                                value={editedEmployee.regularDays}
                                onChange={(e) => setEditedEmployee({...editedEmployee, regularDays: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Overtime Hours</label>
                            <input
                                type="number"
                                step="0.5"
                                value={editedEmployee.overtimeHours}
                                onChange={(e) => setEditedEmployee({...editedEmployee, overtimeHours: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Regular Hours</label>
                            <input
                                type="number"
                                step="0.5"
                                value={editedEmployee.regularHours}
                                onChange={(e) => setEditedEmployee({...editedEmployee, regularHours: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Deduction (₹)</label>
                            <input
                                type="number"
                                step="0.01"
                                value={editedEmployee.deduction}
                                onChange={(e) => setEditedEmployee({...editedEmployee, deduction: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Advance (₹)</label>
                            <input
                                type="number"
                                step="0.01"
                                value={editedEmployee.advance}
                                onChange={(e) => setEditedEmployee({...editedEmployee, advance: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                        
                        <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Salary Paid (₹)</label>
                            <input
                                type="number"
                                step="0.01"
                                value={editedEmployee.salaryPaid}
                                onChange={(e) => setEditedEmployee({...editedEmployee, salaryPaid: parseFloat(e.target.value) || 0})}
                                className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500"
                            />
                        </div>
                    </div>

                    <div className="flex gap-3 mt-6">
                        <button
                            onClick={handleSave}
                            disabled={!editedEmployee.name}
                            className="flex-1 bg-purple-600 text-white py-3 rounded-lg font-semibold hover:bg-purple-700 transition disabled:bg-gray-400"
                        >
                            Save Changes
                        </button>
                        <button
                            onClick={onCancel}
                            className="flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-400 transition"
                        >
                            Cancel
                        </button>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<SalaryApp />, document.getElementById('root'));
    </script>
</body>
</html>
